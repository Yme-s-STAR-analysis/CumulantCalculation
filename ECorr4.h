#ifndef __ECORR4HEADER__
#define __ECORR4HEADER__

#include <vector>
#include <cmath>
#include "Rtypes.h"

class TProfile;
class TH1D;
class TFile;
class TGraphErrors;

class ECorr {

  	public:
		ECorr(const char*, int, int);
		~ECorr();
		void Init();
		void ReadTerms(const char *FileName = "noCbwc.root");
		void Calculate();
		void Save(const  char* OutName = "output.root");
		void Update(const  char* OutName = "output.root");

		TH1D* GetCumulant(int Order);                  
		TH1D* GetCumulantRatio(int RatioName);
		TH1D* GetFactorialCumulant(int Order);         
		TH1D* GetFactorialCumulantRatio(int RatioName);
		TH1D* GetEntriesHistogram();

		Double_t NonNan(Double_t val) { return std::isnan(val) ? 0 : val; }

  	private:
		int _nMultBin;
		const char* ParticleType;
		int LowEventCut;
		TProfile* _V[225]; // -> _nTerms + 1
		TH1D* hEntries;
		//Double_t _q[7][7];
		//Attentation! bin center is integer multplicity value
		//zero multiplicity bin is not stored
    	//e.g. _sC[1]->GetBinContent(5) -> get C1'bin value at mult == 5
		TH1D* _sM[4];  //store each multiplicity bin's xx
		TH1D* _sC[4];  //store each multiplicity bin's xx
		TH1D* _sR21;
		TH1D* _sR32;
		TH1D* _sR42;
		TH1D* _sk[4];
		TH1D* _sk21;
		TH1D* _sk31;
		TH1D* _sk41;
		// new: ppb, C2/ppb, C3/ppb, C3/C1
		TH1D* _sppb;
		TH1D* _sR2s;
		TH1D* _sR3s;
		TH1D* _sR31;
    	static const Int_t _nTerms = 224; //2535 terms for current cumulant species
		const Char_t* Terms[_nTerms]={"q01_01q02_01q02_02q03_02", "q01_01q02_01q02_02q03_01", "q01_01q02_01q02_02q03_03", "q01_01_2q02_01_2q02_02", "q01_01_2q02_01q02_02_2", "q01_01q02_01_2q03_03", "q01_01q02_02_2q03_03", "q01_01_2q02_02q03_01", "q01_01_2q02_01q04_03", "q01_01_2q02_01q04_02", "q01_01_2q03_02q03_03", "q01_01q02_01_2q02_02", "q01_01_2q03_01q03_02", "q01_01q02_01_2q03_02", "q01_01_2q02_01q04_04", "q01_01_3q02_01q03_02", "q01_01q02_02_2q03_01", "q01_01_3q02_02q03_01", "q01_01_3q02_01q03_03", "q01_01_2q02_02q04_01", "q01_01_2q02_02q04_04", "q01_01q02_01_2q03_01", "q01_01_2q02_01q03_01", "q01_01_4q02_01q02_02", "q01_01_2q02_01q03_03", "q01_01_3q02_02q03_03", "q01_01q02_01q02_02_2", "q01_01_3q02_01q03_01", "q01_01_3q02_02q03_02", "q01_01_3q02_01q02_02", "q01_01_2q03_01q03_03", "q01_01_2q02_02q04_02", "q01_01_2q02_01q03_02", "q01_01_2q02_01q04_01", "q01_01_2q02_02q04_03", "q01_01q02_02_2q03_02", "q01_01_2q02_02q03_02", "q01_01_2q02_02q03_03", "q01_01_2q02_01q02_02", "q01_01q02_01q04_01", "q02_01q02_02q04_02", "q02_01q02_02q03_03", "q01_01q02_01q03_03", "q01_01q03_02q03_03", "q02_01q02_02q04_03", "q01_01q02_01q03_01", "q01_01q02_01q04_03", "q01_01q03_02q04_01", "q02_01q02_02q04_04", "q01_01q03_01q04_01", "q01_01q03_03q04_01", "q02_01q02_02q04_01", "q01_01q02_01q03_02", "q01_01q02_02q04_02", "q01_01q02_01q04_04", "q01_01q03_02q04_02", "q01_01q03_01q04_02", "q01_01q02_02q04_04", "q01_01q02_02q03_01", "q01_01q02_02q04_01", "q01_01q03_01q04_04", "q01_01q03_03q04_02", "q02_01q02_02q03_01", "q01_01q02_02q03_03", "q01_01q02_02q03_02", "q01_01q03_03q04_03", "q01_01q02_02q04_03", "q01_01q03_02q04_04", "q02_01q02_02q03_02", "q01_01q03_01q03_03", "q01_01q03_02q04_03", "q01_01q02_01q02_02", "q01_01q03_03q04_04", "q01_01q02_01q04_02", "q01_01q03_01q04_03", "q01_01q03_01q03_02", "q01_01_2q03_02_2", "q01_01_2q03_03_2", "q01_01_4q02_02_2", "q01_01_2q03_01_2", "q01_01_2q02_01_2", "q01_01_3q02_01_2", "q01_01_4q02_01_2", "q02_01_2q02_02_2", "q01_01_2q02_01_3", "q01_01_2q02_02_2", "q01_01_3q02_02_2", "q01_01_2q02_02_3", "q01_01_2q03_02", "q01_01_4q02_01", "q01_01_4q04_03", "q01_01_2q04_04", "q01_01_3q03_03", "q01_01q02_02_2", "q02_02_2q04_04", "q01_01_3q04_03", "q02_01_2q02_02", "q01_01_4q04_04", "q02_01_3q02_02", "q01_01q02_02_3", "q01_01_6q02_02", "q01_01_6q02_01", "q01_01_4q03_02", "q01_01_4q03_03", "q02_02_2q03_01", "q01_01_2q04_02", "q01_01q02_01_2", "q01_01_4q04_02", "q01_01_4q03_01", "q01_01_2q04_01", "q02_02_2q04_03", "q01_01_3q04_02", "q02_01_2q03_03", "q01_01_5q03_02", "q01_01_2q04_03", "q01_01_4q02_02", "q02_01_2q04_02", "q02_01_2q03_01", "q02_01_2q03_02", "q01_01_5q02_01", "q01_01_5q02_02", "q02_01q02_02_3", "q02_02_2q04_02", "q02_02_2q03_02", "q01_01q03_03_2", "q01_01_2q03_01", "q01_01_2q03_03", "q02_01_2q04_03", "q01_01_3q02_02", "q01_01_3q04_01", "q02_01_2q04_04", "q01_01q03_02_2", "q02_01q02_02_2", "q01_01_2q02_02", "q01_01_5q03_03", "q01_01q03_01_2", "q01_01_2q02_01", "q01_01q02_01_3", "q02_02_2q03_03", "q01_01_3q03_01", "q01_01_4q04_01", "q01_01_5q03_01", "q02_01_2q04_01", "q02_02_2q04_01", "q01_01_3q02_01", "q01_01_3q04_04", "q01_01_3q03_02", "q03_03q04_04", "q03_01q04_02", "q03_03q04_02", "q04_03q04_04", "q01_01q03_01", "q02_02q04_01", "q03_02q04_03", "q02_01q04_03", "q03_03q04_03", "q03_01q03_03", "q02_02q04_03", "q02_02q03_02", "q02_01q04_01", "q01_01q02_01", "q02_02q03_03", "q01_01q03_03", "q04_02q04_03", "q04_02q04_04", "q03_01q04_03", "q02_01q04_02", "q03_01q04_01", "q02_01q02_02", "q03_01q04_04", "q02_01q03_01", "q02_01q03_03", "q02_01q04_04", "q01_01q02_02", "q03_03q04_01", "q01_01q04_01", "q03_01q03_02", "q03_02q04_02", "q03_02q03_03", "q02_02q04_02", "q02_01q03_02", "q04_01q04_02", "q01_01q04_04", "q03_02q04_01", "q01_01q03_02", "q01_01q04_02", "q01_01q04_03", "q02_02q03_01", "q02_02q04_04", "q03_02q04_04", "q04_01q04_03", "q04_01q04_04", "q01_01_4", "q02_02_3", "q01_01_8", "q01_01_6", "q03_03_2", "q02_02_2", "q02_01_4", "q04_02_2", "q04_04_2", "q01_01_3", "q01_01_7", "q03_01_2", "q02_02_4", "q02_01_3", "q01_01_5", "q01_01_2", "q04_03_2", "q02_01_2", "q04_01_2", "q03_02_2", "q04_04", "q03_03", "q03_02", "q04_02", "q04_01", "q03_01", "q01_01", "q02_02", "q02_01", "q04_03", "ppb", "q05_01"};

};

#endif